<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <div style="display: flex; justify-content: center">
      <form
        onsubmit="sendMsg(event)"
        style="border: 2px solid grey; padding: 3px; width: 40%"
      >
        <!-- <div
          id="welcome"
          style="
            background-color: rgb(63, 63, 225);
            color: white;
            padding: 10px;
            border: 2px solid white;
            border-radius: 10px;
          "
        ></div> -->
        <div id="status"></div>
        <div id="user"></div>
        <div
          style="
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 10px;
          "
        >
          <input
            type="text"
            id="name"
            placeholder="name"
            style="padding: 10px"
            required
          />
          <div id="body" style="min-height: 200px; height: auto"></div>
          <div style="display: flex">
            <input
              type="text"
              id="myInput"
              placeholder="input"
              style="width: 100%"
              required
            />

            <button
              type="submit"
              style="
                background-color: blue;
                color: white;

                text-align: center;
                font-weight: bolder;
                cursor: pointer;
                padding: 10px;
                border: none;
              "
            >
              Send
            </button>
          </div>
        </div>
      </form>
    </div>
    <script src="http://localhost:3000/socket.io/socket.io.js"></script>

    <script>
      var text = "";
      var connected = [];
      var user;

      const socket = io("http://localhost:3000");

      socket.on("welcome", (data) => {
        let b = document.createElement("div");
        b.innerHTML = `<h3>${data.name}</h3>
              <p>${data.message}</p>
              <p>${data.time}</p>
      `;
        document.getElementById("body").appendChild(b);
        socket.emit("newJoin", { name: "eddy" });
      });

      socket.on("newJoin", (data) => {
        let newJoin = document.createElement("div");
        newJoin.innerHTML = `<p>${data.name} joined the chat</p>
        <p>${data.time}</p>`;
        document.getElementById("body").appendChild(newJoin);
      });

      function sendMsg(event) {
        event.preventDefault();
        console.log(event.target.name.value);
        socket.emit("message", {
          name: event.target.name.value,
          message: event.target.myInput.value,
        });
      }
      socket.on("joinGroup", (data) => {
        console.log("group", data);
      });

      socket.on("groupJoin", (data) => {
        console.log("group", data);
      });
      socket.on("leaveGroup", (data) => {
        console.log("group", data);
      });
      socket.on("groupLeave", (data) => {
        console.log("group", data);
      });
      socket.on("message", (data) => {
        console.log(data);
        let newM = document.createElement("div");
        newM.innerHTML = `<p>${data.name} </p>
              <p>${data.message} </p>
              `;
        document.getElementById("body").appendChild(newM);
      });
      socket.on("left", (data) => {
        let newJoin = document.createElement("div");
        newJoin.innerHTML = `<h2>${data.name} left the chat</h2>
        <p>${data.time}</p>`;
        document.getElementById("body").appendChild(newJoin);
      });
    </script>
  </body>
</html>
